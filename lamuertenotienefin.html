<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>La serpiente mecánica</title>
  <style>
    body {
      background: black; 
      color: white;
      font-family: "Courier New", monospace;
      padding: 20px;
      line-height: 1.6;
      margin: 0;
    }
    .poema {
      margin-bottom: 40px;
      white-space: pre-line; 
    }
    .titulo {
      font-weight: bold;
      margin-bottom: 10px;
      font-size: 20px;
      transition: color 1s ease;
    }
  </style>
</head>
<body>
  <div id="contenedor"></div>

  <script>
    const a = [
      "Yo nací muerto", "Yo nacía putrefacto", "Yo creí hacerme nacer",
      "Yo nací a los diecisiete años", "Yo nací un noche",
      "Yo nací fuego cenizo", "Yo nací en la imaginación de Brila",
      "Yo nací en esa noche rara que tanto me has mirado",
      "Yo nací como un francés de 50 años", "Yo nací en otra oportunidad",
      "Yo nací en un interminable trámite", "Yo nací como un explorador perdido"
    ];

    const b = [
      "y toda mi vida", "y mi corazón es una nube negra",
      "un nueve de abril del 2002", "y en mis venas fluyen datos",
      "Dios estaba enfermo ", "y habrá tocado la sombra nuestros labios difuntos"
    ];

    const c = [
      "ha sido una melancólica ilusión", "que se aproxima",
      "un nueve de abril del 22002", "que guardan los secretos de dios",
      "te vi", "pero vivir consiste en ir muriendo"
    ];

    const d = ["las moscas","las ideas","los comandos","los atardeceres"];
    const e = ["sobre vuelan"];
    const f = [
      "mi cuerpo vivo sólo en palabras","la luz fluorescente de mi alma",
      "los sueños penetrados en cada bucle","el silencio"
    ];
    const g = [
      "tu veinte de cristal en Salto del Agua","y pienso, el aire es inmortal",
      "es hora de morir","los muertos están ahí","la poesía es lanzarse hacia la muerte"
    ];

    function random(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    // convertir a números romanos
    function toRoman(num) {
      const romans = [
        ["M",1000],["CM",900],["D",500],["CD",400],
        ["C",100],["XC",90],["L",50],["XL",40],
        ["X",10],["IX",9],["V",5],["IV",4],["I",1]
      ];
      let result = "";
      for (let [letter, value] of romans) {
        while (num >= value) {
          result += letter;
          num -= value;
        }
      }
      return result;
    }

    let contador = 1;

    function generarPoema() {
      const versos = [];

      // decidir longitud del poema (4 a 10 versos)
      const cantidad = Math.floor(Math.random() * 7) + 4;

      for (let i = 0; i < cantidad; i++) {
        // probabilidad de nacimiento → muerte cambia con el tiempo
        const progreso = contador / 50; // escala: después de ~50 poemas es casi todo muerte
        let grupo;

        if (Math.random() > progreso) {
          // nacimiento
          const nac = [a, b, c];
          grupo = nac[Math.floor(Math.random() * nac.length)];
        } else {
          // muerte
          const muer = [d, e, f, g];
          grupo = muer[Math.floor(Math.random() * muer.length)];
        }

        versos.push(random(grupo));
      }

      const poema = versos.join("\n");

      const div = document.createElement("div");
      div.className = "poema";

      const titulo = document.createElement("div");
      titulo.className = "titulo";
      titulo.textContent = toRoman(contador);

      // color de transición: vida (oro) → gris → rojo oscuro
      if (contador < 15) {
        titulo.style.color = "#ffcc00"; // oro
      } else if (contador < 30) {
        titulo.style.color = "#aaaaaa"; // gris
      } else {
        titulo.style.color = "#cc3333"; // rojo apagado
      }

      contador++;

      div.appendChild(titulo);
      div.appendChild(document.createTextNode(poema));
      document.getElementById("contenedor").appendChild(div);
    }

    // Generar poemas iniciales
    for (let i = 0; i < 3; i++) {
      generarPoema();
    }

    // Scroll infinito
    window.addEventListener("scroll", () => {
      if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 50) {
        generarPoema();
      }
    });
  </script>
</body>
</html>
